<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Id Card</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="icon" href="./avatar.png">
</head>

<body>
    <!-- Trigger/Open The Modal -->
    <div class="center">
        <h1>Id Card</h1>
        <button id="myBtn">Create</button>
    </div>

    <!-- The Modal -->
    <div id="myModal" class="modal">

        <!-- Modal content -->
        <div class="modal-content">
            <span class="close">&times;</span>

            <div class="center">
                <h1>Create Id Card</h1>
                <div class="fields" id="newField">
                    <label for="name">Name</label>
                    <input type="text" name="name" id="name"><br>
                    <label for="date">DOB</label>
                    <input type="date" name="date" id="date"><br>
                    <label for="class">Class</label>
                    <input type="text" name="class" id="class"><br>
                    <label for="photo">Photo</label>
                    <input type="file" name="photo" id="photo" accept="image/gif, image/jpeg, image/png"
                        onchange="loadFile(event)"><br>
                </div>
                <button id="myBtn" onclick="previewCard()">Preview</button>
                <button id="myBtn" onclick="newField()">New Field</button>
            </div>
        </div>

        <div class="modal-content" id="idCard">
            <!-- <span class="close">&times;</span> -->

            <div class="center">
                <h1>Id Card</h1>
                <div class="fields">
                    <img id="showPhoto" width="100" height="100"></img><br>
                    <b>Name:</b>
                    <i id="showName"></i><br>
                    <b>DOB:</b>
                    <i id="showDate"></i><br>
                    <b>Class:</b>
                    <i id="showClass"></i><br>
                </div>
                <!-- <button id="myBtn" onclick="downloadCard()">Download</button> -->
            </div>
        </div>

    </div>

    <div id="myModal2" class="modal2">
        <div class="modal-content">
            <!-- <span class="close">&times;</span> -->

            <div class="center">
                <h1>Add New Field</h1>
                <div class="fields">
                    <label for="labelName">Field Label</label>
                    <input type="text" name="labelName" id="labelName"><br>
                    <label for="labelType">Field Type</label>
                    <select name="labelType" id="labelType">
                        <option value="text">Text</option>
                        <option value="date">Date</option>
                        <option value="number">Number</option>
                    </select>
                    <br>
                </div>

                <button id="myBtn" onclick="cancelField()">Cancel</button>
                <button id="myBtn" onclick="addField()">Add</button>
            </div>
        </div>
    </div>
</body>
<script>

    // Get the modal
    var modal = document.getElementById("myModal");
    var modal2 = document.getElementById("myModal2");

    // Get the button that opens the modal
    var btn = document.getElementById("myBtn");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks on the button, open the modal
    btn.onclick = function () {
        modal.style.display = "block";
    }

    // When the user clicks on <span> (x), close the modal
    span.onclick = function () {
        modal.style.display = "none";
        document.getElementById('idCard').style.display = "none";
    }

    // When the user clicks anywhere outside of the modal, close it
    window.onclick = function (event) {
        if (event.target == modal) {
            modal.style.display = "none";
            document.getElementById('idCard').style.display = "none";
        }
    }

    function previewCard() {

        var name = document.getElementById('name').value;
        var date = document.getElementById('date').value;
        var clas = document.getElementById('class').value;

        document.getElementById('showName').innerText = name;
        document.getElementById('showDate').innerText = date;
        document.getElementById('showClass').innerText = clas;

        document.getElementById('idCard').style.display = 'block';
        window.location = "#idCard";
    }

    var loadFile = function (event) {
        var image = document.getElementById('showPhoto');
        image.src = URL.createObjectURL(event.target.files[0]);
    }

    /*
    function downloadCard() {
        var a = document.createElement('a');
        a.href = "./index.html#idCard";
        a.download = "output.jpg";
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
    }*/

    function newField() {
        modal.style.display = "none";
        modal2.style.display = "block";

    }

    function addField() {

        //let labelName = document.getElementById("labelName").value;

        let labelName = document.getElementById("labelName").value;
        //let labeltype = document.getElementById("labelType").value;
        let labelVal = document.getElementsByName('labelType')[0];
        let labelType = labelVal.options[labelVal.selectedIndex].text;

        let label = document.createElement('label');
        let br = document.createElement('br');
        let inputType = document.createElement('input');

        label.appendChild(document.createTextNode(labelName));
        inputType.setAttribute('type',labelType);

        document.getElementById("newField").appendChild(label);
        document.getElementById("newField").appendChild(inputType);
        document.getElementById("newField").appendChild(br);

        modal2.style.display = "none";
        modal.style.display = "block";

    }

    function cancelField() {
        modal.style.display = "block";
        modal2.style.display = "none";
    }

</script>

</html>